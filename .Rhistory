ifelse(cdat[,9]==1, cdat[,10:ncol(cdat)]=0,
ifelse(cdat[,11]==1, cdat[,12:ncol(cdat)]=0,
ifelse(cdat[,13]==1, cdat[,14:ncol(cdat)]=0,NA))))))
cdat[,3]==1
ncol(cdat)
names(cdat)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
summary(cdat)
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat <- cdat[1:10,]
cdat
cdat[2,4] <- 1
cdat
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
ncol(cdat)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat[,15][cdat$"2010_dead"==1,]<-0
cdat[,15][cdat$"2011_dead"==1,]<-0
cdat <- cbind(cdat, sex[,2:3])
cdat <- cbind(cdat, age[,2:4])
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", " ", cdat$"4", " ", cdat$"5",";",sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- data.frame(cdat$band_id, cdat$cap)
write.table(enhist[,2], 'live_dead_enhist.inp', row.names=F, col.names=F, quote=F)
head(enhist)
cdat
head(cdat)
colnames(cdat[,16:ncol(cdat)]) <- c("male","female","AHY","HY","Local","cap")
head(cdat)
cdat[,16:ncol(cdat)]
head(cdadt[,16:ncol(cdat)])
head(cdat[,16:ncol(cdat)])
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat <- cbind(cdat, sex[,2:3])
cdat <- cbind(cdat, age[,2:4])
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
head(cdat)
colnames(cdat) <- c("band_id","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead","male","female","AHY","HY","Local","cap")
colnames(cdat) <- c("band_id","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead","male","female","ahy","hy","local")
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", " ", cdat$male, " ", cdat$female," ",cdat$ahy," ",cdat$hy," ", cdat$local, ";", sep="")
head(cdat)
enhist <- data.frame(cdat$band_id, cdat$cap)
write.table(enhist[,2], 'live_dead_enhist.inp', row.names=F, col.names=F, quote=F)
write.table(enhist[,2], 'live_dead_enhist_clean.inp', row.names=F, col.names=F, quote=F)
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat <- cbind(cdat, sex[,2:3])
cdat <- cbind(cdat, age[,2:4])
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
colnames(cdat) <- c("band_id","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead","male","female","ahy","hy","local")
#create capture history
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", " ", cdat$male, " ", cdat$female," ",cdat$ahy," ",cdat$hy," ", cdat$local, ";", sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- data.frame(cdat$band_id, cdat$cap)
write.table(enhist[,2], 'live_dead_enhist_clean.inp', row.names=F, col.names=F, quote=F)
library(RMark)
data(dipper)
myfirstmodel=mark(dipper)
list.files()
is.null(myfirstmodel$results$singular)
coef(myfirstmodel)
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat <- cbind(cdat, sex[,2:3])
cdat <- cbind(cdat, age[,2:4])
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
colnames(cdat) <- c("band_id","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead","male","female","ahy","hy","local")
#create capture history
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
head(cdat)
class(cdat)
enhist <- cdat[,c("cap","sex","age")]
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
# live/dead recover encouter history ------------------------------
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat <- cbind(cdat, sex[,2:3])
cdat <- cbind(cdat, age[,2:4])
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
colnames(cdat) <- c("band_id","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead","male","female","ahy","hy","local")
#create capture history
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- cdat[,c("cap","sex","age")]
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("ch","sex","age")
head(cdat)
enhist <- cdat[,c("cap","male","female","ahy","hy","local")]
enhist$cdat.cap <- as.character(enhist$cdat.cap)
str(enhist)
colnames(enhist) <- c("ch","male","female","ahy","hy","local")
head(enhist)
write.table(enhist, 'live_dead_enhist.txt', row.names=F)
head(dipper)
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
head(cdat)
colnames(cdat) <- c("band_id","sex","age","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead")
head9cdat
head(cdat)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", sep="")
head(cdat)
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- cdat[,c("cap","sex","age")]
colnames(enhist) <- c("ch","sex","age")
head(enhist)
write.table(enhist, 'live_dead_enhist.txt', row.names=F)
dat <- import.chdata('live_dead_enhist.txt',field.types=c("f","age"))
head(dat)
summary(dat)
?process.data
dat.proc=process.data(dat,model="Burnham",groups=c("sex","age"))
summary(dat)
unique(dat$ch)
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
# live/dead recover encouter history ------------------------------
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
head(cdat)
summary(cdat)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
colnames(cdat) <- c("band_id","sex","age","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead")
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", sep="")
unique(cdat$cap)
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- cdat[,c("cap","sex","age")]
colnames(enhist) <- c("ch","sex","age")
write.table(enhist, 'live_dead_enhist.txt', row.names=F)
dat <- import.chdata('live_dead_enhist.txt')
head(dat)
unique(dat$ch)
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
# live/dead recover encouter history ------------------------------
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
head(cdat)
summary(cdat)
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
# live/dead recover encouter history ------------------------------
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[2:ncol(cdat)] <- ifelse(cdat[2:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
# live/dead recover encouter history ------------------------------
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
sex <- cast(data=rat, band_id ~ sex)
age <- cast(data=rat, band_id ~ age)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat[,4:ncol(cdat)][cdat$"2005_dead"==1,]<-0
cdat[,6:ncol(cdat)][cdat$"2006_dead"==1,]<-0
cdat[,8:ncol(cdat)][cdat$"2007_dead"==1,]<-0
cdat[,10:ncol(cdat)][cdat$"2008_dead"==1,]<-0
cdat[,12:ncol(cdat)][cdat$"2009_dead"==1,]<-0
cdat[,14:ncol(cdat)][cdat$"2010_dead"==1,]<-0
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
summary(cdat)
colnames(cdat) <- c("band_id","sex","age","2005_alive","2005_dead","2006_alive","2006_dead","2007_alive","2007_dead","2008_alive","2008_dead","2009_alive","2009_dead","2010_alive","2010_dead","2011_alive","2011_dead")
#create capture history
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
enhist <- cdat[,c("cap","sex","age")]
colnames(enhist) <- c("ch","sex","age")
write.table(enhist, 'live_dead_enhist.txt', row.names=F)
dat <- import.chdata('live_dead_enhist.txt')
summary(dat)
unique(dat$ch)
dat.proc=process.data(dat,model="Burnham",groups=c("sex","age"))
dat.proc=process.data(dat,model="Burnham",groups=c("sex","age"),begin.time=2005)
dat.ddl=make.design.data(dat.proc)
summary(dat.ddl)
summary(dat.ddl$Phi)
summary(dat.ddl$p)
ncol(dat)
length(dat)
length(dat.ddl)
dat.ddl
dat
summary(dat.ddp)
summary(dat.ddl)
model.1=mark(dat.proc,dat.ddl,model.parmeters=list(S=S.dot,p=p.dot,r=r.dot,f=f.dot))
S.dot=list(formula=~1)
p.dot=list(formula=~1)
r.dot=list(formula=~1)
F.dot=list(formula=~1)
S.sex.age.time=list(formula=~age+sex+tile)
S.sex.age=list(formula=~age+sex)
S.sex.time=list(formula=~sex+time)
S.age.time=list(formula=~age+time)
S.age=list(formula=~age)
S.sex=list(formula=~sex)
S.time=list(formula=~time)
model.1=mark(dat.proc,dat.ddl,model.parmeters=list(S=S.dot,p=p.dot,r=r.dot))
model.1=mark(dat.proc,dat.ddl)
model.2=mark(dat.proc, dat.ddl, model.parameters=list(S=S.sex.age.time))
model.2=mark(dat.proc, dat.ddl, model.parameters=list(S=S.sex))
model.3=mark(dat.proc, dat.ddl, model.parameters=list(S=S.time))
model.4=mark(dat.proc, dat.ddl, model.parameters=list(S=S.age))
model.5=mark(dat.proc, dat.ddl, model.parameters=list(S=S.sex.time))
model.6=mark(dat.proc, dat.ddl, model.parameters=list(S=S.age.time))
model.7=mark(dat.proc, dat.ddl, model.parameters=list(S=S.sex.age.time))
S.sex.age.time=list(formula=~age+sex+tile)
S.sex.age.time
summary(model.3)
model.3
cml=create.model.list(“Burnham”)
?create.model.list
cml=create.model.list(model="Burnham")
model.list=mark.wrapper(cml,data=dat.proc,ddl=dat.ddl)
return(model.list)
model.list
S.dot=list(formula=~1)
p.dot=list(formula=~1)
r.dot=list(formula=~1)
S.sex.age.time=list(formula=~age+sex+tile)
S.sex.age=list(formula=~age+sex)
S.sex.time=list(formula=~sex+time)
S.age.time=list(formula=~age+time)
S.age=list(formula=~age)
S.sex=list(formula=~sex)
S.time=list(formula=~time)
p.sex.age=list(formula=~age+sex)
p.sex.time=list(formula=~sex+tile)
p.age.time=list(formula=~age+tile)
p.age=list(formula=~age)
p.sex=list(formula=~sex)
p.time=list(formula=~tile)
cml=create.model.list(model="Burnham")
cml
model.list=mark.wrapper(cml,data=dat.proc,ddl=dat.ddl)
model.list
S.dot=list(formula=~1)
p.dot=list(formula=~1)
r.dot=list(formula=~1)
S.sex.age.time=list(formula=~age+sex+tile)
S.sex.age=list(formula=~age+sex)
S.sex.time=list(formula=~sex+time)
S.age.time=list(formula=~age+time)
S.age=list(formula=~age)
S.sex=list(formula=~sex)
S.time=list(formula=~time)
p.sex.age=list(formula=~age+sex)
p.sex.time=list(formula=~sex+tile)
p.age.time=list(formula=~age+tile)
p.age=list(formula=~age)
p.sex=list(formula=~sex)
p.time=list(formula=~tile)
r.sex.age=list(formula=~age+sex)
r.sex.time=list(formula=~sex+tile)
r.age.time=list(formula=~age+tile)
r.age=list(formula=~age)
r.sex=list(formula=~sex)
r.time=list(formula=~tile)
cml=create.model.list(model="Burnham")
model.list=mark.wrapper(cml,data=dat.proc,ddl=dat.ddl)
model.list
