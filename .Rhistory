panel.grid.minor = element_line(colour=NA))
library(ggplot2)
library(reshape2)
#import predicted densities
value13 <- data.frame(cat=c("PE","MS","UP"), round_1=c(13,25,NA), round_2=c(15,35,3), round_3=c(61,56,8),round_4=c(13,35,NA))
#import predicted SE
se13 <- data.frame(cat=c("PE","MS","UP"),round_1=c(3,2,NA),round_2=c(3,2.5,4),round_3=c(4,1,3),round_4=c(3.5,2,NA))
cbPalette <- c("#E69F00", "#56B4E9", "#009E73")
#melt the standard errors into long form
meltse = melt(se13)
#melt the predicted values into long form
melt = melt(value13)
#add the standard errors to the predicted values as a fourth column
melt[,4] = meltse[,3]
melt$V5 <- -melt$V4
ggplot() +
geom_bar(data=melt, aes(x=cat, y=value, group=variable, colour=variable, fill=variable),
position=position_dodge(),
stat="identity") +
geom_errorbar(data=melt, aes(ymin=(value-V4), ymax=(value+V4), x=cat, group=variable), position=position_dodge(), stat="identity")+
xlab("X Axis Label") +
ylab("Y Axis Label") +
ggtitle("Plot Title") +
theme(plot.title = element_text(colour="black",size=40), #plot title
axis.text.x = element_text(colour="black", size=20), #x axis labels
axis.text.y = element_blank(), #y axis labels
axis.ticks=element_blank(),
legend.text = element_text(colour="black", size=30), #legend text
legend.title = element_blank(),#legend title
legend.background = element_rect(fill="white"), #legend background color
legend.position = "none",
legend.direction= "horizontal",
plot.background = element_rect(fill = "white" ), #plot background color
panel.background = element_rect(fill = "white"), #panel background color
panel.grid.major.y= element_line(colour="black"), #y axis grid line color
panel.grid.major.x = element_line(colour=NA),
panel.grid.minor = element_line(colour=NA))
library(ggplot2)
library(reshape2)
#import predicted densities
value13 <- data.frame(cat=c("PE","MS","UP"), round_1=c(13,25,NA), round_2=c(15,35,3), round_3=c(61,56,8),round_4=c(13,35,NA))
#import predicted SE
se13 <- data.frame(cat=c("PE","MS","UP"),round_1=c(3,2,NA),round_2=c(3,2.5,4),round_3=c(4,1,3),round_4=c(3.5,2,NA))
cbPalette <- c("#E69F00", "#56B4E9", "#009E73")
#melt the standard errors into long form
meltse = melt(se13)
#melt the predicted values into long form
melt = melt(value13)
#add the standard errors to the predicted values as a fourth column
melt[,4] = meltse[,3]
melt$V5 <- -melt$V4
ggplot() +
geom_bar(data=melt, aes(x=cat, y=value, group=variable, colour=variable, fill=variable),
position=position_dodge(),
stat="identity") +
geom_errorbar(data=melt, aes(ymin=(value-V4), ymax=(value+V4), x=cat, group=variable), position=position_dodge(), stat="identity")+
xlab("X Axis Label") +
ylab("Y Axis Label") +
ggtitle("Plot Title") +
theme(plot.title = element_text(colour="black",size=40), #plot title
axis.text.x = element_text(colour="black", size=20), #x axis labels
axis.text.y = element_blank(), #y axis labels
axis.ticks=element_blank(),
legend.text = element_text(colour="black", size=30), #legend text
legend.title = element_blank(),#legend title
legend.background = element_rect(fill="white"), #legend background color
legend.direction= "horizontal",
plot.background = element_rect(fill = "white" ), #plot background color
panel.background = element_rect(fill = "white"), #panel background color
panel.grid.major.y= element_line(colour="black"), #y axis grid line color
panel.grid.major.x = element_line(colour=NA),
panel.grid.minor = element_line(colour=NA))
library(ggplot2)
library(reshape2)
#import predicted densities
value13 <- data.frame(cat=c("PE","MS","UP"), round_1=c(13,25,NA), round_2=c(15,35,3), round_3=c(61,56,8),round_4=c(13,35,NA))
#import predicted SE
se13 <- data.frame(cat=c("PE","MS","UP"),round_1=c(3,2,NA),round_2=c(3,2.5,4),round_3=c(4,1,3),round_4=c(3.5,2,NA))
cbPalette <- c("#E69F00", "#56B4E9", "#009E73")
#melt the standard errors into long form
meltse = melt(se13)
#melt the predicted values into long form
melt = melt(value13)
#add the standard errors to the predicted values as a fourth column
melt[,4] = meltse[,3]
melt$V5 <- -melt$V4
ggplot() +
geom_bar(data=melt, aes(x=cat, y=value, group=variable, colour=variable, fill=variable),
position=position_dodge(),
stat="identity") +
geom_errorbar(data=melt, aes(ymin=(value-V4), ymax=(value+V4), x=cat, group=variable), position=position_dodge(), stat="identity")+
xlab("X Axis Label") +
ylab("Y Axis Label") +
ggtitle("Plot Title") +
theme(plot.title = element_text(colour="black",size=40), #plot title
axis.text.x = element_text(colour="black", size=20), #x axis labels
axis.text.y = element_blank(), #y axis labels
axis.ticks=element_blank(),
legend.text = element_text(colour="black", size=30), #legend text
legend.title = element_blank(),#legend title
legend.background = element_rect(fill="white"), #legend background color
plot.background = element_rect(fill = "white" ), #plot background color
panel.background = element_rect(fill = "white"), #panel background color
panel.grid.major.y= element_line(colour="black"), #y axis grid line color
panel.grid.major.x = element_line(colour=NA),
panel.grid.minor = element_line(colour=NA))
install.packages("devtools")
devtools::install_github(c("rstudio/rmarkdown", "hadley/bookdown", "hadley/lineprof"))
devtools::install_github(c("hadley/lineprof"))
install.packages(c("inline", "pryr", "microbenchmark", "dplyr", "png", "knitr"))
library('pryr')
f <- function() {}
typeof(f)
is.function(f)
MarkPath = 'C:\Program Files\MARK'
library(RMark)
MarkPath = "C:\Program Files\MARK"
data(example.data)
ls()
myexample=mark(example.data)
library(RMark)
data(dipper)
ls()
myexample=mark(dipper)
library(RMark)
data(dipper)
ls()
myexample=mark(dipper)
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
head(dat)
dat <- dat[,2:ncol(dat)]
head(dat)
model <- mark(dat, model="Barker")
pd <-process.data(dat, model="Barker")
m1 <- mark(pd, model="Barker")
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
model <- mark(dat, model="Barker")
pd <-process.data(dat, model="Barker")
m1 <- mark(pd, model="Barker")
ent <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
head(ent)
ent <- ent[,2:ncol(ent)]
head(ent)
mark(ent)
m1 <- mark(ent)
summary(m1)
m1
m1
setwd("~/SourceTree/data")
dat <- read.csv('2014_waterfowl.csv')
head(dat)
str(dat)
dat <- dat[,2:ncol(dat)]
head(dat)
dates <- dat[,c("month","day","year")]
dates
varmonth<-cbind(c(1:12),c(0,31,59,90,120,151,181,212,243,273,304,334))
juldates<-data.frame(date=as.numeric())
for(i in 1:nrow(dates)) {juldates[i,1]<-varmonth[which(dates[i,1]==varmonth[,1]),2]+dates[i,2]
}
juldates
dat$jdate <- juldates$date
head(dat)
write.csv("2014_waterfowl.csv")
write.csv(dat,"2014_waterfowl.csv")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
setwd("~/SourceTree/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2000,]
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
library(reshape)
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat
head(cdat)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
cdat$cap <- paste(cdat$"2000_alive",cdat$"2000_dead",cdat$"2001_alive",cdat$"2001_dead",cdat$"2002_alive",cdat$"2002_dead",cdat$"2003_alive", cdat$"2003_dead",cdat$"2004_alive",cdat$"2004_dead",cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
head(cdat)
length((cdat$"2000_alive",cdat$"2000_dead",cdat$"2001_alive",cdat$"2001_dead",cdat$"2002_alive",cdat$"2002_dead",cdat$"2003_alive", cdat$"2003_dead",cdat$"2004_alive",cdat$"2004_dead",cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead")
cdat
head(cdat)
write.csv(enhist[,1:4], 'live_dead_enhist.csv')
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist[,1:4], 'live_dead_enhist.csv')
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
head(dat)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
model <- mark(dat, model="Barker")
model
model <- mark(dat, model="Burnham")
model
modle
model
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2000,]
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000_alive",cdat$"2000_dead",cdat$"2001_alive",cdat$"2001_dead",cdat$"2002_alive",cdat$"2002_dead",cdat$"2003_alive", cdat$"2003_dead",cdat$"2004_alive",cdat$"2004_dead",cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
head(cdat)
data(dipper)
head(dipper)
summary(cdat)
data(dipper)
dipper$nsex=as.numeric(dipper$sex)-1 dipper$weight=rnorm(294)
dipper$nsex=as.numeric(dipper$sex)-1
dipper$weight=rnorm(294)
head(dipper)
mod=mark(dipper,model.parameters=list(Phi=list(formula=~nsex+weight))) # Show approach using individual calls to find.covariates, fill.covariates # and compute.real
fc=find.covariates(mod,dipper)
fc$value[fc$var=="nsex"]=0 # assign sex value to Female design=fill.covariates(mod,fc) # fill design matrix with values # compute and output survivals for females at average weight female.survival=compute.real(mod,design=design)[1,]
female.survival
fc=find.covariates(mod,dipper)
fc$value[fc$var=="nsex"]=0 # assign sex value to Female
design=fill.covariates(mod,fc) # fill design matrix with values
female.survival=compute.real(mod,design=design)[1,]
female.survival
female.survival=compute.real(mod,data=data.frame(nsex=0,weight=mean(dipper$weight)))[1,]
female.survival
male.survival=compute.real(mod,data=data.frame(nsex=1, weight=mean(dipper$weight)))[1,]
male.survival
mod=mark(dipper,groups="sex",model.parameters=list(Phi=list(formula=~sex+weight)))
survival.by.sex=compute.real(mod,data=dipper,vcv=TRUE)
survival.by.sex$real[1:2] # estimates
survival.by.sex$se.real[1:2] # std errors
survival.by.sex$vcv.real[1:2,1:2] # v-c matrix
survival.by.sex$vcv.real[1,2]/prod(survival.by.sex$se.real[1:2]) # sampling correlation of the estimates
head(cdat)
head(dat)
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
head(dat)
process.data(dat, begin.time=2000, model="Burnham",groups="sex", age.var="age",age.unit=1,time.intervals=1)
process.data(dat, begin.time=2000, model="Burnham",groups="sex", age.var="age",age.unit=1,time.intervals=c(1,1,1,1,1,1,1,1,1,1,1,1,1))
process.data(dat, begin.time=2000, model="Burnham",groups="sex", age.var="age",age.unit=1)
str(dat)
summary(dat)
process.data(dat, begin.time=2000, model="Burnham",groups="sex", age.var="age")
process.data(dat, begin.time=2000, model="Burnham",groups="sex")
dat <- process.data(dat, begin.time=2000, model="Burnham",groups="sex")
head(dat)
model <- mark(dat, model="Burnham")
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2000,]
head(rat)
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2000,]
# Regular Encounter History ---------------------------------------------------
cdat <- cast(data=rat, band_id + age + sex ~ year)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000",cdat$"2001",cdat$"2002", cdat$"2003",cdat$"2004",cdat$"2005",cdat$"2006",cdat$"2007",cdat$"2008",cdat$"2009",cdat$"2010",cdat$"2011",cdat$"2012",cdat$"2013",cdat$"2014", sep="")
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'enhist.csv')
# live/dead recover encouter history ------------------------------
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2000_alive",cdat$"2000_dead",cdat$"2001_alive",cdat$"2001_dead",cdat$"2002_alive",cdat$"2002_dead",cdat$"2003_alive", cdat$"2003_dead",cdat$"2004_alive",cdat$"2004_dead",cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
cdat$hunt <- ifelse()
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'live_dead_enhist.csv')
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
summary(dat)
dat <- process.data(dat, begin.time=2000, model="Burnham",groups="sex")
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=("sex","age"))
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=c("sex","age"))
# first shot at analyzing
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
#age structure, define groups (sex)
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=c("sex","age"))
model <- mark(dat, model="Burnham")
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
cdat$hunt <- ifelse()
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'live_dead_enhist.csv')
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
#cdat$hunt <- ifelse()
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'live_dead_enhist.csv')
etwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
#age structure, define groups (sex)
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=c("sex","age"))
model <- mark(dat, model="Burnham")
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
#age structure, define groups (sex)
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=c("sex","age"))
model <- mark(dat, model="Burnham")
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
#cdat$hunt <- ifelse()
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'live_dead_enhist.csv')
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
#age structure, define groups (sex)
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=c("sex","age"))
model <- mark(dat, model="Burnham")
cdat <- cdat[cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0&cdat$"2012_alive"==0&cdat$"2013_alive"==0&cdat$"2014_alive"==0,]
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
#cdat$hunt <- ifelse()
nrow(cdat)
cdat <- cdat[cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0&cdat$"2012_alive"==0&cdat$"2013_alive"==0&cdat$"2014_alive"==0,]
nrow(cdat)
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
12631-244
nrow(cdat)
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0&cdat$"2012_alive"==0&cdat$"2013_alive"==0&cdat$"2014_alive"==0),]
nrow(cdat)
enhist <- data.frame(cdat$band_id, cdat$sex , cdat$age, cdat$cap)
enhist$cdat.cap <- as.character(enhist$cdat.cap)
colnames(enhist) <- c("band","sex","age","ch")
write.csv(enhist, 'live_dead_enhist.csv')
# first shot at analyzing
setwd("~/SourceTree/RMark")
library(RMark)
options(scipen=999)
dat <- read.csv("live_dead_enhist.csv",header=T,colClasses=c(NA,NA,NA,NA,"character"))
dat <- dat[,2:ncol(dat)]
#age structure, define groups (sex)
dat <- process.data(dat, begin.time=2000, model="Burnham",groups=c("sex","age"))
model <- mark(dat, model="Burnham")
model
data(weta)
head(weta)
?make.time.factor
weta=make.time.factor(weta,"Obs",1:5,intercept=3)
wetea
weta
# Making Encounter Histories
library(reshape)
setwd("~/RMark")
dat <- read.csv("canada_geese_arkansas.csv",header=T)
dat$b_new_year <- ifelse(dat$banding_month>=6,dat$banding_year, dat$banding_year-1)
dat$e_new_year <- ifelse(dat$encounter_month>=6,dat$encounter_year, dat$encounter_year-1)
b <- dat[,c("band_id","b_new_year","l_d","b_age_code","b_sex_code")]
colnames(b) <- c("band_id","year","l_d","age","sex")
e <- dat[,c("band_id","e_new_year","l_d","b_age_code","b_sex_code")]
colnames(e) <- c("band_id","year","l_d","age","sex")
rat <- rbind(b,e)
rat$num <- 1
rat <- rat[rat$year>=2005,]
rat <- rat[rat$year<=2011,]
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
#create capture history
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead",cdat$"2012_alive",cdat$"2012_dead",cdat$"2013_alive",cdat$"2013_dead",cdat$"2014_alive",cdat$"2014_dead", sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0&cdat$"2012_alive"==0&cdat$"2013_alive"==0&cdat$"2014_alive"==0),]
head(cdat)
rat <- rat[rat$l_d != "unknown",] #remove the unknowns
rat <- rat[rat$sex != 0,] #removes unknown sex
rat <- rat[rat$age != 0,] #removes unknown age
rat <- rat[!(is.na(rat$l_d)),] # remove the NA's
cdat <- cast(data=rat, band_id + sex + age ~ year + l_d)
cdat[4:ncol(cdat)] <- ifelse(cdat[4:ncol(cdat)]>=1, 1,0)
#create capture history
cdat$cap <- paste(cdat$"2005_alive",cdat$"2005_dead",cdat$"2006_alive",cdat$"2006_dead",cdat$"2007_alive",cdat$"2007_dead",cdat$"2008_alive",cdat$"2008_dead",cdat$"2009_alive",cdat$"2009_dead",cdat$"2010_alive",cdat$"2010_dead",cdat$"2011_alive",cdat$"2011_dead", sep="")
# below removes birds banded before 2005 that were never recovered during the study period
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0&cdat),]
head(cdat)
cdat <- cdat[!(cdat$"2005_alive"==0&cdat$"2006_alive"==0&cdat$"2007_alive"==0&cdat$"2008_alive"==0&cdat$"2009_alive"==0&cdat$"2010_alive"==0&cdat$"2011_alive"==0),]
head(cdat)
hunt <- as.data.frame(matrix(ncol=7, nrow(nrow(cdat))))
hunt <- as.data.frame(matrix(ncol=7, nrow=nrow(cdat))))
hunt <- as.data.frame(matrix(ncol=7, nrow=nrow(cdat)))
head(hunt)
hunt$V1&hunt$V2 <- 1
hunt$V1 <- 1
hunt$V2 <- 1
head(hunt)
hunt[3:ncol(hunt),] <- 0
head(hunt)
hunt <- as.data.frame(matrix(ncol=7, nrow=nrow(cdat)))
hunt$V1 <- 1
hunt$V2 <- 1
hunt[,3:ncol(hunt)] <- 0
head(hunt)
hunt <- make.time.factor(hunt, "V",1:7,intercept=0)
